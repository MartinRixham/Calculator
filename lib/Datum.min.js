function Registry(){var a=[],b=!1;this.registerUpdaterAssigner=function(b){a.push(b)},this.requestRegistrations=function(){a=[],b=!0},this.registeringAssigners=function(){return b},this.assignUpdater=function(c,d,e){for(var f=0;f<a.length;f++)a[f](c,d,e);b=!1};var c=null,d=!1;this.rebindDataStructure=function(a){a&&!c?c=a:c&&d&&(d=!1,c())},this.requestRebind=function(){c&&(d=!0)}}function Subscriber(){this.isInScope=function(a,b){return a=a.parentElement,a?a._rebind?a==b:this.isInScope(a,b):!0}}function UniqueRoot(){var a=!1;this.assertUniqueness=function(){if(a)throw{message:"The binding root is unique and cannot be instantiated multiple times.",name:"DatumException"};a=!0}}function Binding(a){this.requestRebind(),setTimeout(this.rebindDataStructure),this.applyBinding=function(b,c,d){if(a.text){var e=new Text(a.text);e.applyBinding(b,c,d)}if(a.value){var f=new Value(a.value);f.applyBinding(b,c,d)}if(a.click){var g=new Click(a.click);g.applyBinding(b,c,d)}if(a.init){var h=new Init(a.init);h.applyBinding(b,c,d)}if(a.update){var i=new Update(a.update);i.applyBinding(b,c,d)}if(a.visible){var j=new Visible(a.visible);j.applyBinding(b,c,d)}}}function BindingRoot(a){this.assertUniqueness();var b=function(a,b,c){var d=new Datum(c);Object.defineProperty(b,a,{get:function(){return d()},set:function(a){d(a)}})};BindingRoot.bindObject=function(a,c){var d=!c._scope;if(c._scope=a,c instanceof Array){new BindingRoot.ForEach(a,c)}else{c.toJSON||new BindingRoot.ViewModel(c),a._rebind=function(){BindingRoot.bindObject(a,c)};for(var e in c)if("_scope"!=e){var f=c[e],g=a.querySelector("[data-bind="+e+"]");f&&f.applyBinding?f.applyBinding(c._scope,e,c):"function"!=typeof f&&(d&&b(e,c,f),g&&"object"==typeof f&&(new BindingRoot.With(c,e,g),f&&BindingRoot.bindObject(g,f)))}}};var c=document.querySelector("body");BindingRoot.bindObject(c,a),this.rebindDataStructure(function(){BindingRoot.bindObject(c,a)});var d=new BindingRoot.DomWatcher(c);this.disconnect=function(){d.disconnect()}}function Click(a){this.addListener=function(b,c){b.addEventListener("click",function(){a.call(c,b)})},this.applyBinding=function(b,c,d){for(var e=b.querySelectorAll("[data-bind="+c+"]"),f=0;f<e.length;f++){var g=e[f];g.callbacks||(g.callbacks=[]);var h=g.callbacks.indexOf(a)+1;!h&&this.isInScope(g,b)&&(this.addListener(g,d),g.callbacks.push(a))}}}function Datum(a){var b=[],c=[],d=this,e=function(e){if("undefined"!=typeof e){d.rebindDataStructure(),a=e;for(var f=0;f<b.length;f++){var g=b[f];document.contains(g.element)||b.splice(f,1)}for(var h=0;h<b.length;h++)b[h](e)}else d.registeringAssigners()&&d.registerUpdaterAssigner(function(a,d,e){!c.indexOf(d)+1&&(a.element=e,b.push(a),d&&c.push(d))});return a};return e}function Init(a){this.applyBinding=function(b,c,d){for(var e=b.querySelectorAll("[data-bind="+c+"]"),f=0;f<e.length;f++){var g=e[f];g.callbacks||(g.callbacks=[]);var h=g.callbacks.indexOf(a)+1;!h&&this.isInScope(g,b)&&(a.call(d,g),g.callbacks.push(a))}}}function Text(a){this.createCallback=function(b,c){this.assignUpdater(function(){c.textContent=a.call(b,c)},this,c)},this.applyBinding=function(b,c,d){for(var e=b.querySelectorAll("[data-bind="+c+"]"),f=0;f<e.length;f++){var g=e[f];this.isInScope(g,b)&&(this.requestRegistrations(),g.textContent=a.call(d,g),this.createCallback(d,g))}}}function Update(a){this.applyBinding=function(b,c,d){for(var e=b.querySelectorAll("[data-bind="+c+"]"),f=this,g=function(b){f.assignUpdater(function(){a.call(d,b)},this,b)},h=0;h<e.length;h++){var i=e[h];i.callbacks||(i.callbacks=[]);var j=i.callbacks.indexOf(a)+1;!j&&this.isInScope(i,b)&&(this.requestRegistrations(),a.call(d,i),g(i),i.callbacks.push(a))}}}function Value(a){this.addCallbacks=function(b,c){b.callbacks||(b.callbacks=[]);var d=b.callbacks.indexOf(a)+1;d||(b.addEventListener("change",function(d){a.call(c,d.target.value,b)}),b.callbacks.push(a)),this.assignUpdater(function(){b.value=a.call(c,void 0,b)},this,b)},this.applyBinding=function(b,c,d){for(var e=b.querySelectorAll("[data-bind="+c+"]"),f=0;f<e.length;f++){var g=e[f];if(this.isInScope(g,b)){this.requestRegistrations();var h=a.call(d,void 0,g);"undefined"!=typeof h&&(g.value=h),this.addCallbacks(g,d)}}}}function Visible(a){this.applyBinding=function(b,c,d){var e=this;this.applyCallback=function(b,c){e.assignUpdater(function(){b.style.display=a.call(d,b)?c:"none"},this,b)};for(var f=b.querySelectorAll("[data-bind="+c+"]"),g=0;g<f.length;g++){var h=f[g];if(this.isInScope(h,b)){var i=getComputedStyle(h).getPropertyValue("display");this.requestRegistrations(),a.call(d,h)||(h.style.display="none"),this.applyCallback(h,i)}}}}Subscriber.prototype=new Registry,UniqueRoot.prototype=new Subscriber,Binding.prototype=new Subscriber,BindingRoot.prototype=new UniqueRoot,Click.prototype=new Subscriber,Datum.prototype=new Subscriber,BindingRoot.DomWatcher=function(a){var b=new MutationObserver(function(a){var b=a[0],c=b.target.children.length;if(c)for(var d=b.target;d;){if(d._rebind){d._rebind();break}d=d.parentElement}});b.observe(a,{childList:!0,subtree:!0}),this.disconnect=function(){b.disconnect()}},BindingRoot.ForEach=function(a,b){var c=null;this.number=function(a,b){if(a.id&&(a.id=a.id+"_"+b),a.hasAttribute&&a.hasAttribute("name")&&a.setAttribute("name",a.getAttribute("name")+"_"+b),a.children)for(var c=0;c<a.children.length;c++){var d=a.children[c];this.number(d,b)}};var d=this;return this.bind=function(a){if(a!=c){a._rebind=function(){},c=a;for(var e=[],f=a.childNodes.length-1;f>=0;f--)e[f]=a.childNodes[f],a.removeChild(a.childNodes[f]);var g=0,h=function(){for(var b=document.createElement(a.nodeName),c=0;c<e.length;c++){var f=e[c],h=f.cloneNode(!0);d.number(h,g),b.appendChild(h)}return g+=1,b},i=function(b){for(var c=0;c<b.length;c++){var d=b[c],e=h();a.appendChild(e),"object"==typeof d&&BindingRoot.bindObject(e,d)}},j=function(b){for(var c=0;c<b.length;c++){var d=b[c],e=h();a.insertBefore(e,a.firstChild),"object"==typeof d&&BindingRoot.bindObject(e,d)}};i(b);var k=b.push;b.push=function(){k.apply(b,arguments),i(arguments)};var l=b.pop;b.pop=function(){l.apply(b,arguments),a.removeChild(a.lastElementChild)};var m=b.shift;b.shift=function(){m.apply(b,arguments),a.removeChild(a.firstElementChild)};var n=b.unshift;b.unshift=function(){n.apply(b,arguments),j(arguments)}}else for(var o=0;o<b.length;o++)BindingRoot.bindObject(a.children[o],b[o])},b.applyBinding=function(a,b,c){a=a.querySelector("[data-bind="+b+"]"),new BindingRoot.With(c,b,a),d.bind(a)},this.bind(a),b},Init.prototype=new Subscriber,Text.prototype=new Subscriber,Update.prototype=new Subscriber,Value.prototype=new Subscriber,BindingRoot.ViewModel=function(a){a||(a={}),this.toJSON=function(a){var b={};a instanceof Array&&(b=[]);for(var c in a){var d=a[c];"_scope"!=c&&(d&&"object"==typeof d&&(!d.applyBinding||d instanceof Array)&&(b[c]=this.toJSON(d)),(!d||"object"!=typeof d&&"function"!=typeof d)&&(b[c]=d))}return b};var b=this;return a.toJSON=function(){return JSON.stringify(b.toJSON(a))},a},Visible.prototype=new Subscriber,BindingRoot.With=function(a,b,c){c.boundObjects||(c.boundObjects=[]);var d=c.boundObjects.indexOf(a)+1;if(!d){c.boundObjects.push(a);for(var e=[],f=0;f<c.childNodes.length;f++)e[f]=c.childNodes[f];this.requestRegistrations();var g=a[b];g||e.forEach(function(a){c.removeChild(a)}),this.assignUpdater(function(){for(var d=a[b],f=c.childNodes.length-1;f>=0;f--)c.removeChild(c.childNodes[f]);d&&(e.forEach(function(a){c.appendChild(a)}),BindingRoot.bindObject(c,d))},this,c)}},BindingRoot.With.prototype=new Subscriber;